<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.restaurant.admin.faq.dao.AdminFaqDAO">

	<!-- 검색 조건 -->
	<sql id="faqCommon">
		select *
		from faq
	</sql>

	<!-- faq 목록 -->
	<select id="faqList" resultType="faq" parameterType="faq">
		select faq_no, faq_title,faq_text,faq_type, faq_date
		from (SELECT list.*, ROWNUM AS RNUM FROM (
		<include refid="faqCommon"></include>
		<choose>
			<when test="order_by=='faq_no'"> ORDER BY faq_no</when>
			<when test="order_by=='faq_date'"> ORDER BY faq_date</when>
		</choose>
		<choose>
			<when test="order_sc=='ASC'"> ASC</when>
			<when test="order_sc=='DESC'"> DESC</when>
		</choose>
		) list)
		<where>
			<if test="start_row != null and start_row != ''">
				<if test="end_row != null and end_row != ''"> RNUM BETWEEN #{start_row} AND
					#{end_row}
				</if>
			</if>
		</where>
	</select>
	<!-- 게시물 전체 개수 -->
	<select id="faqListCnt" parameterType="faq" resultType="int">
		SELECT NVL(count(1), 0) FROM (SELECT list.*, ROWNUM AS RNUM FROM (
		<include refid="faqCommon"></include>
		ORDER BY faq_no desc) list )
	</select>
	<!-- faq 상세보기 -->
	<select id="faqDetail">
		select
		faq_no,
		faq_title,
		faq_text,
		faq_type,
		faq_date
		from faq
		where faq_no =
		#{faq_no}
	</select>
	<!-- faq 추가 -->
	<insert id="faqInsert">
		<selectKey keyProperty="faq_no" resultType="int" order="BEFORE">
			select faq_seq.nextval from dual
		</selectKey>
		insert into faq( faq_no,faq_title,faq_text,faq_type,
		faq_date)
		values(
		#{faq_no},
		#{faq_title},
		#{faq_text},
		#{faq_type},
		sysdate
		)
	</insert>
	<!-- faq 수정 -->
	<update id="faqUpdate" parameterType="faq">
		update faq
		faq_no,
		faq_title
		= #{faq_title},
		faq_text =
		#{faq_text},
		faq_type = #{faq_type},
		faq_date =
		sysdate
		from faq
		where faq_no =
		#{faq_no}
	</update>
	<!-- faq 삭제 -->
	<delete id="faqDelete" parameterType="faq">
		delete from FAQ
		where
		FAQ_NO
		= #{faq_no}
	</delete>
</mapper>
